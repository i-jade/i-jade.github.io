(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{608:function(n,t,e){"use strict";e.r(t);var i=e(70),s=Object(i.a)({},(function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("blockquote",[e("p",[n._v("Android8.0的Notification添加了用户渠道，使得Android7.0的通知不在适配8.0。新设计让用户有了更多的自主选择权利，更人性化，应该及时学会新变化，跟上新内容。")])]),n._v(" "),e("h2",{attrs:{id:"错误信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#错误信息"}},[n._v("#")]),n._v(" 错误信息")]),n._v(" "),e("ul",[e("li",[n._v("今天打开Android studio，运行以前的音乐项目，当我在手机上进行调试的时候出现了如下错误：")])]),n._v(" "),e("p",[e("img",{attrs:{src:"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDIvMjQvNWM3MjlkNWRiMTFmMS5wbmc?x-oss-process=image/format,png",alt:""}})]),n._v(" "),e("ul",[e("li",[n._v("经过上网搜索，得知Android 8.0 对于Notification有了新的设计，具体原因见下图：")])]),n._v(" "),e("p",[e("img",{attrs:{src:"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDIvMjQvNWM3MjlkNWRiNzAxZC5wbmc?x-oss-process=image/format,png",alt:""}})]),n._v(" "),e("h2",{attrs:{id:"解决办法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决办法"}},[n._v("#")]),n._v(" 解决办法")]),n._v(" "),e("ul",[e("li",[e("p",[n._v("在Android8.0后 需要给notification设置一个channelid，这里有"),e("a",{attrs:{href:"https://github.com/googlesamples/android-NotificationChannels/",target:"_blank",rel:"noopener noreferrer"}},[n._v("官方的代码"),e("OutboundLink")],1),n._v("。具体的做法就是创建一个NotificationChannel，修改后的代码如下：")]),n._v(" "),e("p",[n._v("[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-HxafB7PO-1571190794185)(https://i.loli.net/2019/02/24/5c72a1b5c1ae4.png)]")])]),n._v(" "),e("li",[e("p",[n._v("代码改动的地方有两处，下面是改动的代码：")])])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('      if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.O) {\n      notificationChannel = new NotificationChannel(CHANNEL_ONE_ID,\n              CHANNEL_ONE_NAME, NotificationManager.IMPORTANCE_HIGH);\n      notificationChannel.enableLights(true);\n      notificationChannel.setLightColor(Color.RED);\n      notificationChannel.setShowBadge(true);\n      notificationChannel.setLockscreenVisibility(Notification.VISIBILITY_PUBLIC);\n      NotificationManager manager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);\n      manager.createNotificationChannel(notificationChannel);\n       PendingIntent contentIntents = PendingIntent.getActivity(this, 0, intents, 0);\n      //新增setChannelId()方法--------------------------------------\n      mbuilder = new Notification.Builder(this).setChannelId(CHANNEL_ONE_ID);\n      mRemoteViews = new RemoteViews(getPackageName(), R.layout.notification);\n      mbuilder.setContent(mRemoteViews)\n              .setContentIntent(contentIntents)\n              .setSmallIcon(R.mipmap.music)\n              .setContentText(name);\n\n\n       mRemoteViews.setTextViewText(R.id.notification_name, musiclist.get(curposition).getTitle());\n      mRemoteViews.setTextViewText(R.id.notification_arti, musiclist.get(curposition).getArtist());\n\n      //为intent添加play属性\n      Intent intentnext = new Intent("next");\n      PendingIntent pintentnext = PendingIntent.getBroadcast(this, 0, intentnext, 0);\n      mRemoteViews.setOnClickPendingIntent(R.id.btn_custom_next, pintentnext);\n      Intent intentplay = new Intent("play");\n      PendingIntent pintentplay = PendingIntent.getBroadcast(this, 0, intentplay, 0);\n      mRemoteViews.setOnClickPendingIntent(R.id.btn_custom_play, pintentplay);\n      Intent intentpause = new Intent("pause");\n      PendingIntent pintentpause = PendingIntent.getBroadcast(this, 0, intentpause, 0);\n      mRemoteViews.setOnClickPendingIntent(R.id.btn_custom_pause, pintentpause);\n      Notification notify = mbuilder.build();\n      startForeground(1, notify);\n  }\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br")])])])}),[],!1,null,null,null);t.default=s.exports}}]);